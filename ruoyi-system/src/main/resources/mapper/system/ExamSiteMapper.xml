<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.ExamSiteMapper">

	<resultMap type="ExamSite" id="ExamSiteResult">
		<id     property="siteId"         column="site_id"          />
		<result property="siteName"       column="site_name"        />
		<result property="siteCode"       column="site_code"        />
		<result property="province"       column="province"         />
		<result property="city"           column="city"             />
		<result property="district"       column="district"         />
		<result property="address"        column="address"          />
		<result property="contactPerson"  column="contact_person"   />
		<result property="contactPhone"   column="contact_phone"    />
		<result property="capacity"       column="capacity"         />
		<result property="status"         column="status"           />
		<result property="sortOrder"      column="sort_order"       />
		<result property="createBy"       column="create_by"        />
		<result property="createTime"     column="create_time"      />
		<result property="updateBy"       column="update_by"        />
		<result property="updateTime"     column="update_time"      />
		<result property="remark"         column="remark"           />
	</resultMap>
	
	<sql id="selectExamSiteVo">
        select site_id, site_name, site_code, province, city, district, address, 
               contact_person, contact_phone, capacity, status, sort_order,
               create_by, create_time, update_by, update_time, remark 
		from exam_site
    </sql>
	
	<select id="selectExamSiteList" parameterType="ExamSite" resultMap="ExamSiteResult">
	    <include refid="selectExamSiteVo"/>
		<where>
			<if test="siteName != null and siteName != ''">
				AND site_name like concat('%', #{siteName}, '%')
			</if>
			<if test="siteCode != null and siteCode != ''">
				AND site_code like concat('%', #{siteCode}, '%')
			</if>
			<if test="province != null and province != ''">
				AND province = #{province}
			</if>
			<if test="city != null and city != ''">
				AND city = #{city}
			</if>
			<if test="status != null and status != ''">
				AND status = #{status}
			</if>
		</where>
		order by sort_order, site_id
	</select>
	
	<select id="selectExamSiteAll" resultMap="ExamSiteResult">
		<include refid="selectExamSiteVo"/>
		where status = '0'
		order by sort_order, site_id
	</select>
	
	<select id="selectExamSiteById" parameterType="Long" resultMap="ExamSiteResult">
		<include refid="selectExamSiteVo"/>
		where site_id = #{siteId}
	</select>
	
	<select id="checkSiteNameUnique" parameterType="String" resultMap="ExamSiteResult">
		<include refid="selectExamSiteVo"/>
		where site_name = #{siteName} limit 1
	</select>
	
	<select id="checkSiteCodeUnique" parameterType="String" resultMap="ExamSiteResult">
		<include refid="selectExamSiteVo"/>
		where site_code = #{siteCode} limit 1
	</select>
	
	<insert id="insertExamSite" parameterType="ExamSite" useGeneratedKeys="true" keyProperty="siteId">
 		insert into exam_site(
 			<if test="siteName != null and siteName != ''">site_name,</if>
 			<if test="siteCode != null and siteCode != ''">site_code,</if>
 			<if test="province != null and province != ''">province,</if>
 			<if test="city != null and city != ''">city,</if>
 			<if test="district != null and district != ''">district,</if>
 			<if test="address != null and address != ''">address,</if>
 			<if test="contactPerson != null and contactPerson != ''">contact_person,</if>
 			<if test="contactPhone != null and contactPhone != ''">contact_phone,</if>
 			<if test="capacity != null">capacity,</if>
 			<if test="status != null and status != ''">status,</if>
 			<if test="sortOrder != null">sort_order,</if>
 			<if test="remark != null and remark != ''">remark,</if>
 			<if test="createBy != null and createBy != ''">create_by,</if>
 			create_time
 		)values(
 			<if test="siteName != null and siteName != ''">#{siteName},</if>
 			<if test="siteCode != null and siteCode != ''">#{siteCode},</if>
 			<if test="province != null and province != ''">#{province},</if>
 			<if test="city != null and city != ''">#{city},</if>
 			<if test="district != null and district != ''">#{district},</if>
 			<if test="address != null and address != ''">#{address},</if>
 			<if test="contactPerson != null and contactPerson != ''">#{contactPerson},</if>
 			<if test="contactPhone != null and contactPhone != ''">#{contactPhone},</if>
 			<if test="capacity != null">#{capacity},</if>
 			<if test="status != null and status != ''">#{status},</if>
 			<if test="sortOrder != null">#{sortOrder},</if>
 			<if test="remark != null and remark != ''">#{remark},</if>
 			<if test="createBy != null and createBy != ''">#{createBy},</if>
 			sysdate()
 		)
	</insert>
	
	<update id="updateExamSite" parameterType="ExamSite">
 		update exam_site
 		<set>
 			<if test="siteName != null and siteName != ''">site_name = #{siteName},</if>
 			<if test="siteCode != null and siteCode != ''">site_code = #{siteCode},</if>
 			<if test="province != null">province = #{province},</if>
 			<if test="city != null">city = #{city},</if>
 			<if test="district != null">district = #{district},</if>
 			<if test="address != null">address = #{address},</if>
 			<if test="contactPerson != null">contact_person = #{contactPerson},</if>
 			<if test="contactPhone != null">contact_phone = #{contactPhone},</if>
 			<if test="capacity != null">capacity = #{capacity},</if>
 			<if test="status != null and status != ''">status = #{status},</if>
 			<if test="sortOrder != null">sort_order = #{sortOrder},</if>
 			<if test="remark != null">remark = #{remark},</if>
 			<if test="updateBy != null and updateBy != ''">update_by = #{updateBy},</if>
 			update_time = sysdate()
 		</set>
 		where site_id = #{siteId}
	</update>
	
	<delete id="deleteExamSiteById" parameterType="Long">
		delete from exam_site where site_id = #{siteId}
	</delete>
	
	<delete id="deleteExamSiteByIds" parameterType="Long">
 		delete from exam_site where site_id in
 		<foreach collection="array" item="siteId" open="(" separator="," close=")">
 			#{siteId}
        </foreach> 
 	</delete>

</mapper>
